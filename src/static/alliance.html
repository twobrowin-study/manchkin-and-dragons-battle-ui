<!doctype html>
<html>
    <head>
        <title>üõ°Ô∏è –ê–ª—å—è–Ω—Å</title>
        <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
        <script src="js/jquery-3.7.1.min.js"></script>
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/bootstrap-icons.min.css" rel="stylesheet">
        <style>
            #overlay { 
                display: none; 
                background: #2d2d2d;
                width: 100%;
                height: 500px;
            };
        </style> 
    </head>
    <body>
        <div id="overlay" class="z-1 position-absolut text-center align-text-middlee"> 
            <span id="overlay-text" style="color: white; font-size: 150px; padding-top: 25px;">
            </span>
        </div>
        <h1 class="text-center">üõ°Ô∏è –ê–ª—å—è–Ω—Å</h1>
        <hr>
        <table class="hero-info table table-striped ">
            <tr>
                <th class="text-start" colspan="1" style="width: 75px;">üßôüèª‚Äç‚ôÇÔ∏è –ò–º—è</th>
                <td id="alliance_name" class="text-start" colspan="3"></td>
                <th class="text-end"   colspan="1">üìà –£—Ä–æ–≤–µ–Ω—å</th>
                <td id="alliance_level" class="text-start" colspan="1"></td>
            </tr>
            <tr>
                <th class="text-end"   colspan="3" style="width: 200px;">‚ù§Ô∏è –ó–¥–æ—Ä–æ–≤—å–µ</th>
                <td id="alliance_health" class="text-start" colspan="3"></td>
            </tr>
            <tr>
                <th class="text-stat"   colspan="2" style="width: 80px;">‚öïÔ∏è –¢–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ</th>
                <td id="alliance_constitution" class="text-start" colspan="1"  style="width: 175px;"></td>
                <th class="text-end"   colspan="2">üó°Ô∏è –°–∏–ª–∞</th>
                <td id="alliance_strength" class="text-start" colspan="1"></td>
            </tr>
            <tr>
                <th class="text-stat"   colspan="2" style="width: 75px;">üéØ –õ–æ–≤–∫–æ—Å—Ç—å</th>
                <td id="alliance_dexterity" class="text-start" colspan="1"  style="width: 175px;"></td>
                <th class="text-end"   colspan="2">‚≠êÔ∏è –ú—É–¥—Ä–æ—Å—Ç—å</th>
                <td id="alliance_wisdom" class="text-start" colspan="1"></td>
            </tr>
        </table>

        <script> 
            $(() => {
                setInterval(() => $.ajax({
                    url:  '/alliance',
                    type: 'GET',
                    headers: {
                        Accept: 'application/json',
                    },
                    success: (data) => {
                        console.log(data)
                        if (data.alliance_color) {
                            $("#overlay").css({background: data.alliance_color});
                        }
                        
                        if (data.alliance_bi) {
                            $("#overlay").fadeIn("swing");
                            data.alliance_bi.split('\n').forEach((item) => {
                                $(`<i class="bi bi-${item}"></i>`).appendTo("#overlay-text");
                            });
                            setTimeout(() => {
                                $(".bi").remove();
                                $("#overlay").fadeOut("swing");
                            }, 4000); 
                        }                        
                        
                        $('#alliance_name')        .text(`${data.alliance_name}`);
                        $('#alliance_level')       .text(`${data.alliance_level}`);
                        $('#alliance_health')      .text(`${data.alliance_health}`);
                        $('#alliance_constitution').text(`${data.alliance_constitution}`);
                        $('#alliance_strength')    .text(`${data.alliance_strength}`);
                        $('#alliance_dexterity')   .text(`${data.alliance_dexterity}`);
                        $('#alliance_wisdom')      .text(`${data.alliance_wisdom}`);
                    }
                }), 1000)
            });
        </script> 
    </body>
</html>